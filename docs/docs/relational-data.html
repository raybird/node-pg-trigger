<h1>🔗 關聯資料查詢 (Relational Data)</h1>

<p>不同於 NoSQL，<code>node-pg-trigger</code> 完美發揮了 PostgreSQL 的關聯優勢，支援在單次訂閱中獲取跨表的關聯數據。</p>

<hr>

<h2>使用 include 展開關聯</h2>

<p>透過 <code>include()</code> 語法，您可以指示後端執行高效的 <code>JOIN</code> 並將結果嵌套在 JSON 中返回。</p>

<h3>1:1 關聯範例</h3>
<p>獲取文章時，同時取得作者的資訊：</p>
<pre><code>sdk.collection('posts')
   .include('author') // 需在資料庫層定義好 FK 關聯
   .onSnapshot(snap => {
     // 輸出包含 { ..., author: { name: 'Ray' } }
   });</code></pre>

<h3>1:N 子集合語法</h3>
<p>獲取使用者及其所有的訂單：</p>
<pre><code>sdk.doc('users', 'user_123')
   .collection('orders')
   .onSnapshot(orders => {
     console.log('該使用者的訂單:', orders);
   });</code></pre>

<hr>

<h2>效能提示</h2>
<p><code>include</code> 在後端使用 <code>JSON_AGG</code> 實作，對於前端而言是單次請求，效能優於多次迴圈查詢。但請注意不要過度嵌套（建議不超過 3 層），以維持最佳推送效能。</p>

<hr>

<h2>🎓 接下來</h2>
<p>掌握 <a href="#/docs/rls-best-practices">RLS 最佳實踐</a> 確保這些關聯數據的安全性。</p>
