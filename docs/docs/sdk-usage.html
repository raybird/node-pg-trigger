<h1>ğŸ’ SDK ä½¿ç”¨æŒ‡å—</h1>
<p>æˆ‘å€‘çš„ SDK æä¾›äº†ä¸€å¥—æ¥µç°¡çš„ä»‹é¢ä¾†èˆ‡è³‡æ–™åº«äº’å‹•ã€‚</p>

<h2>1. å»ºç«‹ SDK</h2>
<pre><code>
import { createSdk } from './client';
const sdk = createSdk('http://localhost:5000');
</code></pre>

<h2>2. å³æ™‚è¨‚é–±ï¼ˆCollectionï¼‰</h2>
<pre><code>
const unsubscribe = await sdk
  .collection('users')
  .onSnapshot(({ action, record }) => {
    console.log('ç•°å‹•é¡å‹ï¼š', action);
    console.log('æœ€æ–°è³‡æ–™ï¼š', record);
  });

// é›¢é–‹é é¢æ™‚å»ºè­°è§£é™¤è¨‚é–±
unsubscribe();
</code></pre>

<h2>3. valueChanges / subscribe åˆ¥å</h2>
<pre><code>
await sdk.collection('users').valueChanges((rows) => {
  console.log('åªæœ‰è³‡æ–™æœ¬é«”ï¼š', rows);
});

await sdk.collection('users').subscribe(({ action, record }) => {
  console.log('subscribe åˆ¥åï¼š', action, record);
});
</code></pre>

<h2>4. æ–‡ä»¶æ“ä½œï¼ˆDocumentï¼‰</h2>
<pre><code>
const userRef = sdk.doc('users', 1);

const exists = await userRef.exists();
if (exists) {
  await userRef.update({ name: 'Ray Bird' });
}

await userRef.set({ status: 'active' }, { merge: true });
await userRef.delete();
</code></pre>

<h2>5. æŸ¥è©¢èˆ‡ cursor è¦–çª—</h2>
<pre><code>
const rows = await sdk
  .collection('users')
  .where('status', '==', 'active')
  .orderBy('created_at', 'asc')
  .startAfter('2026-02-20T00:00:00.000Z')
  .endAt('2026-02-20T23:59:59.999Z')
  .limit(20)
  .get();

const count = await sdk
  .collection('users')
  .where('status', '==', 'active')
  .count();
</code></pre>

<h2>6. FieldValue ä¼ºæœå™¨åŸå­æ“ä½œ</h2>
<pre><code>
import { FieldValue } from './client';

await sdk.collection('posts').add({
  title: 'New Post',
  createdAt: FieldValue.serverTimestamp(),
});

await sdk.doc('posts', 1).update({
  views: FieldValue.increment(1),
  tags: FieldValue.arrayUnion('news'),
});
</code></pre>

<h2>7. withConverter æ¬„ä½æ˜ å°„</h2>
<pre><code>
const userConverter = {
  fromFirestore(row) {
    return { id: row.id, displayName: row.name };
  },
  toFirestore(model) {
    return { name: model.displayName };
  },
};

const users = sdk.collection('users').withConverter(userConverter);
const list = await users.get();
console.log(list[0].displayName);
</code></pre>

<p>æ›´å¤š API é€ŸæŸ¥è«‹è¦‹ï¼š<code>docs/firestore-realtime-cheatsheet.md</code></p>
